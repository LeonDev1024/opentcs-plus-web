@use './variables.module.scss' as *;

#app {
  .main-container {
    height: 100%;
    transition: margin-left var(--duration-300) var(--ease-in-out);
    margin-left: var(--sidebar-width);
    position: relative;
    background: var(--bg-secondary);
  }

  .sidebarHide {
    margin-left: 0 !important;
  }

  .sidebar-container {
    transition: width var(--duration-300) var(--ease-in-out);
    width: var(--sidebar-width) !important;
    background: linear-gradient(180deg, var(--menuBg) 0%, rgba(15, 23, 42, 0.98) 100%);
    height: 100%;
    position: fixed;
    font-size: 0;
    top: 0;
    bottom: 0;
    left: 0;
    z-index: 1001;
    overflow: hidden;
    box-shadow: var(--shadow-xl);

    .horizontal-collapse-transition {
      transition:
        0s width ease-in-out,
        0s padding-left ease-in-out,
        0s padding-right ease-in-out;
    }

    .scrollbar-wrapper {
      overflow-x: hidden !important;
    }

    .el-scrollbar__bar.is-vertical {
      right: 0;
    }

    .el-scrollbar {
      height: 100%;
    }

    &.has-logo {
      .el-scrollbar {
        height: calc(100% - var(--navbar-height));
      }
    }

    .is-horizontal {
      display: none;
    }

    a {
      display: inline-block;
      width: 100%;
      overflow: hidden;
    }

    .svg-icon {
      margin-right: var(--spacing-3);
      font-size: 18px;
      transition: var(--transition-transform);
    }

    .el-menu {
      border: none;
      height: 100%;
      width: 100% !important;
      background: transparent;
    }

    .el-menu-item,
    .menu-title {
      overflow: hidden !important;
      text-overflow: ellipsis !important;
      white-space: nowrap !important;
    }

    .el-menu-item .el-menu-tooltip__trigger {
      display: inline-block !important;
    }

    // 菜单项通用样式
    .el-menu-item,
    .el-sub-menu__title {
      height: 48px !important;
      line-height: 48px !important;
      margin: 2px var(--spacing-2);
      border-radius: var(--radius-lg);
      transition: var(--transition-all);
      position: relative;
      overflow: hidden;
      
      &::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        width: 3px;
        height: 100%;
        background: var(--primary-500);
        transform: scaleY(0);
        transition: transform var(--duration-200) var(--ease-in-out);
      }
      
      &:hover {
        background: rgba(255, 255, 255, 0.08) !important;
        transform: translateX(2px);
        
        .svg-icon {
          transform: scale(1.1);
        }
      }
      
      &.is-active {
        background: var(--menuActiveBg) !important;
        color: #fff !important;
        font-weight: var(--font-weight-semibold);
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        
        &::before {
          transform: scaleY(1);
        }
        
        .svg-icon {
          transform: scale(1.15);
        }
      }
    }

    // 子菜单样式
    .el-sub-menu {
      .el-sub-menu__title {
        &:hover {
          background: rgba(255, 255, 255, 0.08) !important;
        }
      }
      
      .el-menu {
        .el-menu-item {
          padding-left: calc(var(--el-menu-base-level-padding) + 20px) !important;
          height: 44px !important;
          line-height: 44px !important;
          margin: 1px var(--spacing-2);
          
          &:hover {
            background: rgba(255, 255, 255, 0.05) !important;
          }
          
          &.is-active {
            background: linear-gradient(90deg, rgba(59, 130, 246, 0.2) 0%, rgba(37, 99, 235, 0.1) 100%) !important;
            color: var(--primary-300) !important;
          }
        }
      }
    }

    // 暗色主题特定样式
    .theme-dark {
      .el-menu-item,
      .el-sub-menu__title {
        &:hover {
          background: rgba(255, 255, 255, 0.08) !important;
        }
      }
    }
  }

  // 收起菜单后的样式
  .hideSidebar {
    .sidebar-container {
      width: var(--sidebar-collapsed-width) !important;
    }

    .main-container {
      margin-left: var(--sidebar-collapsed-width);
    }

    .el-menu {
      .el-menu-item,
      .el-sub-menu__title {
        padding: 0 !important;
        text-align: center;
        
        .svg-icon {
          margin-right: 0 !important;
        }
      }
    }

    .el-menu--collapse {
      .el-sub-menu {
        & > .el-sub-menu__title {
          & > span {
            height: 0;
            width: 0;
            overflow: hidden;
            visibility: hidden;
            display: inline-block;
          }
          & > i {
            height: 0;
            width: 0;
            overflow: hidden;
            visibility: hidden;
            display: inline-block;
          }
        }
      }
      
      .is-active .svg-icon {
        fill: #fff;
      }
      
      .svg-icon {
        display: flex;
        margin: auto;
        height: 100%;
      }
    }
  }

  .el-menu--collapse .el-menu .el-sub-menu {
    min-width: var(--sidebar-width) !important;
  }

  // 移动端响应式
  .mobile {
    .main-container {
      margin-left: 0px;
    }

    .sidebar-container {
      transition: transform var(--duration-300) var(--ease-in-out);
      width: var(--sidebar-width) !important;
    }

    &.hideSidebar {
      .sidebar-container {
        pointer-events: none;
        transition-duration: var(--duration-300);
        transform: translate3d(calc(-1 * var(--sidebar-width)), 0, 0);
      }
    }
  }

  .withoutAnimation {
    .main-container,
    .sidebar-container {
      transition: none;
    }
  }
}

// 收起菜单后悬浮的菜单样式
.el-popper.is-pure {
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-dropdown);
  border: 1px solid var(--border-light);
  background: var(--bg-primary);
  
  .el-menu--popup {
    border-radius: var(--radius-lg);
    padding: var(--spacing-1);
    min-width: 180px;
  }
  
  .el-menu-item {
    border-radius: var(--radius-md);
    margin: 2px var(--spacing-1);
    transition: var(--transition-all);
    
    &:hover {
      background: var(--bg-secondary);
      transform: translateX(4px);
    }
    
    &.is-active {
      background: var(--primary-50);
      color: var(--primary-600);
    }
  }
  
  .el-sub-menu__title {
    border-radius: var(--radius-md);
    margin: 2px var(--spacing-1);
    
    &:hover {
      background: var(--bg-secondary);
    }
  }
}

// Logo 区域优化
.sidebar-logo-container {
  position: relative;
  height: var(--navbar-height);
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  
  &::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 60%;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.3), transparent);
  }
  
  .sidebar-logo-link {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 0 12px;
    text-decoration: none;
    box-sizing: border-box;
    
    .sidebar-logo {
      width: 24px;
      height: 24px;
      flex-shrink: 0;
    }
    
    .sidebar-title {
      margin: 0;
      font-size: 13px;
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      line-height: 1;
      flex: 1;
      min-width: 0;
    }
  }
}
