import{a9 as K,d as ne,h as Ke,ab as le,r as b,ag as te,N as we,b as Ee,ah as Ne,c as ae,o as r,m as t,q as o,w as V,p as F,e as l,C as Ue,D as oe,z as Se,B as Pe,H as he,G as m,a6 as se,ai as Fe,t as u,x as g,R as Ie,b2 as qe,$ as xe,v as Re,Y as $e,y as B,F as De,A as Oe,aj as Te}from"./index-B9WM9B43.js";/* empty css                  *//* empty css                       */import{a as Be,E as He}from"./el-radio-Cy5OMmSA.js";import{_ as Le}from"./index-F9iJ6oEr.js";import{E as ze,a as Ae}from"./el-table-column-CfNB-tiT.js";import"./el-checkbox-CIZQMxKL.js";import{E as Qe}from"./el-row-CZ85bKL9.js";import{_ as je}from"./index-CfXeGV0Q.js";import{E as Ge}from"./el-col-DjEila-N.js";import{E as Ye}from"./el-card-C9-IEzMj.js";import{a as Me,E as Je}from"./el-form-item-C52vg3Rn.js";import"./_initCloneObject-CtNQcUp4.js";import"./el-tree-FBGJd7y4.js";import"./_baseClone-DI-sfL8c.js";function We(f){return K({url:"/resource/oss/config/list",method:"get",params:f})}function Xe(f){return K({url:"/resource/oss/config/"+f,method:"get"})}function Ze(f){return K({url:"/resource/oss/config",method:"post",data:f})}function el(f){return K({url:"/resource/oss/config",method:"put",data:f})}function ll(f){return K({url:"/resource/oss/config/"+f,method:"delete"})}function tl(f,i,I){return K({url:"/resource/oss/config/changeStatus",method:"put",data:{ossConfigId:f,status:i,configKey:I}})}const al={class:"p-2"},ol={class:"mb-[10px]"},sl={style:{color:"#999"}},nl={style:{color:"#999"}},il={class:"dialog-footer"},rl=ne({name:"OssConfig"}),wl=ne({...rl,setup(f){const{proxy:i}=Ke(),{sys_yes_no:I}=le(i==null?void 0:i.useDict("sys_yes_no")),q=b([]),N=b(!1),w=b(!0),U=b(!0),x=b([]),H=b(!0),L=b(!0),R=b(0),z=b(),$=b(),v=te({visible:!1,title:""}),_=b([{key:0,label:"主建",visible:!1},{key:1,label:"配置key",visible:!0},{key:2,label:"访问站点",visible:!0},{key:3,label:"自定义域名",visible:!0},{key:4,label:"桶名称",visible:!0},{key:5,label:"前缀",visible:!0},{key:6,label:"域",visible:!0},{key:7,label:"桶权限类型",visible:!0},{key:8,label:"状态",visible:!0}]),A={ossConfigId:void 0,configKey:"",accessKey:"",secretKey:"",bucketName:"",prefix:"",endpoint:"",domain:"",isHttps:"N",accessPolicy:"1",region:"",status:"1",remark:""},ie=te({form:{...A},queryParams:{pageNum:1,pageSize:10,configKey:"",bucketName:"",status:""},rules:{configKey:[{required:!0,message:"configKey不能为空",trigger:"blur"}],accessKey:[{required:!0,message:"accessKey不能为空",trigger:"blur"},{min:2,max:200,message:"accessKey长度必须介于 2 和 100 之间",trigger:"blur"}],secretKey:[{required:!0,message:"secretKey不能为空",trigger:"blur"},{min:2,max:100,message:"secretKey长度必须介于 2 和 100 之间",trigger:"blur"}],bucketName:[{required:!0,message:"bucketName不能为空",trigger:"blur"},{min:2,max:100,message:"bucketName长度必须介于 2 和 100 之间",trigger:"blur"}],endpoint:[{required:!0,message:"endpoint不能为空",trigger:"blur"},{min:2,max:100,message:"endpoint名称长度必须介于 2 和 100 之间",trigger:"blur"}],accessPolicy:[{required:!0,message:"accessPolicy不能为空",trigger:"blur"}]}}),{queryParams:p,form:n,rules:re}=le(ie),Q=we(()=>n.value.isHttps==="Y"?"https://":"http://"),C=async()=>{w.value=!0;const s=await We(p.value);q.value=s.rows,R.value=s.total,w.value=!1},ue=()=>{v.visible=!1,D()},D=()=>{var s;n.value={...A},(s=$.value)==null||s.resetFields()},S=()=>{p.value.pageNum=1,C()},de=()=>{var s;(s=z.value)==null||s.resetFields(),S()},me=s=>{x.value=s.map(e=>e.ossConfigId),H.value=s.length!=1,L.value=!s.length},pe=()=>{D(),v.visible=!0,v.title="添加对象存储配置"},j=async s=>{D();const e=(s==null?void 0:s.ossConfigId)||x.value[0],c=await Xe(e);Object.assign(n.value,c.data),v.visible=!0,v.title="修改对象存储配置"},ce=()=>{var s;(s=$.value)==null||s.validate(async e=>{e&&(N.value=!0,n.value.ossConfigId?await el(n.value).finally(()=>N.value=!1):await Ze(n.value).finally(()=>N.value=!1),i==null||i.$modal.msgSuccess("新增成功"),v.visible=!1,await C())})},fe=async s=>{const e=s.status==="0"?"启用":"停用";try{await(i==null?void 0:i.$modal.confirm('确认要"'+e+'""'+s.configKey+'"配置吗?')),await tl(s.ossConfigId,s.status,s.configKey),await C(),i==null||i.$modal.msgSuccess(e+"成功")}catch{return}finally{s.status=s.status==="0"?"1":"0"}},G=async s=>{const e=(s==null?void 0:s.ossConfigId)||x.value;await(i==null?void 0:i.$modal.confirm('是否确认删除OSS配置编号为"'+e+'"的数据项?')),w.value=!0,await ll(e).finally(()=>w.value=!1),await C(),i==null||i.$modal.msgSuccess("删除成功")};return Ee(()=>{C()}),(s,e)=>{var Z,ee;const c=Ue,d=Je,Y=Pe,ge=Se,k=he,M=Me,J=Ye,O=Ge,ye=je,be=Qe,y=Ae,T=Ie,ve=qe,W=xe,_e=ze,ke=Le,P=He,X=Be,Ve=Te,E=Ne("hasPermi"),Ce=Re;return r(),ae("div",al,[t(Fe,{"enter-active-class":(Z=l(i))==null?void 0:Z.animate.searchAnimate.enter,"leave-active-class":(ee=l(i))==null?void 0:ee.animate.searchAnimate.leave},{default:o(()=>[V(F("div",ol,[t(J,{shadow:"hover"},{default:o(()=>[t(M,{ref_key:"queryFormRef",ref:z,model:l(p),inline:!0},{default:o(()=>[t(d,{label:"配置key",prop:"configKey"},{default:o(()=>[t(c,{modelValue:l(p).configKey,"onUpdate:modelValue":e[0]||(e[0]=a=>l(p).configKey=a),placeholder:"配置key",clearable:"",onKeyup:oe(S,["enter"])},null,8,["modelValue"])]),_:1}),t(d,{label:"桶名称",prop:"bucketName"},{default:o(()=>[t(c,{modelValue:l(p).bucketName,"onUpdate:modelValue":e[1]||(e[1]=a=>l(p).bucketName=a),placeholder:"请输入桶名称",clearable:"",onKeyup:oe(S,["enter"])},null,8,["modelValue"])]),_:1}),t(d,{label:"是否默认",prop:"status"},{default:o(()=>[t(ge,{modelValue:l(p).status,"onUpdate:modelValue":e[2]||(e[2]=a=>l(p).status=a),placeholder:"请选择状态",clearable:""},{default:o(()=>[t(Y,{key:"0",label:"是",value:"0"}),t(Y,{key:"1",label:"否",value:"1"})]),_:1},8,["modelValue"])]),_:1}),t(d,null,{default:o(()=>[t(k,{type:"primary",icon:"search",onClick:S},{default:o(()=>e[20]||(e[20]=[m("搜索")])),_:1}),t(k,{icon:"Refresh",onClick:de},{default:o(()=>e[21]||(e[21]=[m("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[se,l(U)]])]),_:1},8,["enter-active-class","leave-active-class"]),t(J,{shadow:"hover"},{header:o(()=>[t(be,{gutter:10,class:"mb8"},{default:o(()=>[t(O,{span:1.5},{default:o(()=>[V((r(),u(k,{type:"primary",plain:"",icon:"Plus",onClick:pe},{default:o(()=>e[22]||(e[22]=[m("新增")])),_:1})),[[E,["system:ossConfig:add"]]])]),_:1}),t(O,{span:1.5},{default:o(()=>[V((r(),u(k,{type:"success",plain:"",icon:"Edit",disabled:l(H),onClick:e[3]||(e[3]=a=>j())},{default:o(()=>e[23]||(e[23]=[m("修改")])),_:1},8,["disabled"])),[[E,["system:ossConfig:edit"]]])]),_:1}),t(O,{span:1.5},{default:o(()=>[V((r(),u(k,{type:"danger",plain:"",icon:"Delete",disabled:l(L),onClick:e[4]||(e[4]=a=>G())},{default:o(()=>e[24]||(e[24]=[m(" 删除 ")])),_:1},8,["disabled"])),[[E,["system:ossConfig:remove"]]])]),_:1}),t(ye,{"show-search":l(U),"onUpdate:showSearch":e[5]||(e[5]=a=>$e(U)?U.value=a:null),onQueryTable:C},null,8,["show-search"])]),_:1})]),default:o(()=>[V((r(),u(_e,{border:"",data:l(q),onSelectionChange:me},{default:o(()=>[t(y,{type:"selection",width:"55",align:"center"}),l(_)[0].visible?(r(),u(y,{key:0,label:"主建",align:"center",prop:"ossConfigId"})):g("",!0),l(_)[1].visible?(r(),u(y,{key:1,label:"配置key",align:"center",prop:"configKey"})):g("",!0),l(_)[2].visible?(r(),u(y,{key:2,label:"访问站点",align:"center",prop:"endpoint",width:"200"})):g("",!0),l(_)[3].visible?(r(),u(y,{key:3,label:"自定义域名",align:"center",prop:"domain",width:"200"})):g("",!0),l(_)[4].visible?(r(),u(y,{key:4,label:"桶名称",align:"center",prop:"bucketName"})):g("",!0),l(_)[5].visible?(r(),u(y,{key:5,label:"前缀",align:"center",prop:"prefix"})):g("",!0),l(_)[6].visible?(r(),u(y,{key:6,label:"域",align:"center",prop:"region"})):g("",!0),l(_)[7].visible?(r(),u(y,{key:7,label:"桶权限类型",align:"center",prop:"accessPolicy"},{default:o(a=>[a.row.accessPolicy==="0"?(r(),u(T,{key:0,type:"warning"},{default:o(()=>e[25]||(e[25]=[m("private")])),_:1})):g("",!0),a.row.accessPolicy==="1"?(r(),u(T,{key:1,type:"success"},{default:o(()=>e[26]||(e[26]=[m("public")])),_:1})):g("",!0),a.row.accessPolicy==="2"?(r(),u(T,{key:2,type:"info"},{default:o(()=>e[27]||(e[27]=[m("custom")])),_:1})):g("",!0)]),_:1})):g("",!0),l(_)[8].visible?(r(),u(y,{key:8,label:"是否默认",align:"center",prop:"status"},{default:o(a=>[t(ve,{modelValue:a.row.status,"onUpdate:modelValue":h=>a.row.status=h,"active-value":"0","inactive-value":"1",onChange:h=>fe(a.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):g("",!0),t(y,{label:"操作",fixed:"right",align:"center",width:"150","class-name":"small-padding"},{default:o(a=>[t(W,{content:"修改",placement:"top"},{default:o(()=>[V(t(k,{link:"",type:"primary",icon:"Edit",onClick:h=>j(a.row)},null,8,["onClick"]),[[E,["system:ossConfig:edit"]]])]),_:2},1024),t(W,{content:"删除",placement:"top"},{default:o(()=>[V(t(k,{link:"",type:"primary",icon:"Delete",onClick:h=>G(a.row)},null,8,["onClick"]),[[E,["system:ossConfig:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[Ce,l(w)]]),V(t(ke,{page:l(p).pageNum,"onUpdate:page":e[6]||(e[6]=a=>l(p).pageNum=a),limit:l(p).pageSize,"onUpdate:limit":e[7]||(e[7]=a=>l(p).pageSize=a),total:l(R),onPagination:C},null,8,["page","limit","total"]),[[se,l(R)>0]])]),_:1}),t(Ve,{modelValue:l(v).visible,"onUpdate:modelValue":e[19]||(e[19]=a=>l(v).visible=a),title:l(v).title,width:"800px","append-to-body":""},{footer:o(()=>[F("div",il,[t(k,{loading:l(N),type:"primary",onClick:ce},{default:o(()=>e[31]||(e[31]=[m("确 定")])),_:1},8,["loading"]),t(k,{onClick:ue},{default:o(()=>e[32]||(e[32]=[m("取 消")])),_:1})])]),default:o(()=>[t(M,{ref_key:"ossConfigFormRef",ref:$,model:l(n),rules:l(re),"label-width":"120px"},{default:o(()=>[t(d,{label:"配置key",prop:"configKey"},{default:o(()=>[t(c,{modelValue:l(n).configKey,"onUpdate:modelValue":e[8]||(e[8]=a=>l(n).configKey=a),placeholder:"请输入配置key"},null,8,["modelValue"])]),_:1}),t(d,{label:"访问站点",prop:"endpoint"},{default:o(()=>[t(c,{modelValue:l(n).endpoint,"onUpdate:modelValue":e[9]||(e[9]=a=>l(n).endpoint=a),placeholder:"请输入访问站点"},{prefix:o(()=>[F("span",sl,B(l(Q)),1)]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"自定义域名",prop:"domain"},{default:o(()=>[t(c,{modelValue:l(n).domain,"onUpdate:modelValue":e[10]||(e[10]=a=>l(n).domain=a),placeholder:"请输入自定义域名"},{prefix:o(()=>[F("span",nl,B(l(Q)),1)]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"accessKey",prop:"accessKey"},{default:o(()=>[t(c,{modelValue:l(n).accessKey,"onUpdate:modelValue":e[11]||(e[11]=a=>l(n).accessKey=a),placeholder:"请输入accessKey"},null,8,["modelValue"])]),_:1}),t(d,{label:"secretKey",prop:"secretKey"},{default:o(()=>[t(c,{modelValue:l(n).secretKey,"onUpdate:modelValue":e[12]||(e[12]=a=>l(n).secretKey=a),placeholder:"请输入秘钥","show-password":""},null,8,["modelValue"])]),_:1}),t(d,{label:"桶名称",prop:"bucketName"},{default:o(()=>[t(c,{modelValue:l(n).bucketName,"onUpdate:modelValue":e[13]||(e[13]=a=>l(n).bucketName=a),placeholder:"请输入桶名称"},null,8,["modelValue"])]),_:1}),t(d,{label:"前缀",prop:"prefix"},{default:o(()=>[t(c,{modelValue:l(n).prefix,"onUpdate:modelValue":e[14]||(e[14]=a=>l(n).prefix=a),placeholder:"请输入前缀"},null,8,["modelValue"])]),_:1}),t(d,{label:"是否HTTPS"},{default:o(()=>[t(X,{modelValue:l(n).isHttps,"onUpdate:modelValue":e[15]||(e[15]=a=>l(n).isHttps=a)},{default:o(()=>[(r(!0),ae(De,null,Oe(l(I),a=>(r(),u(P,{key:a.value,value:a.value},{default:o(()=>[m(B(a.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"桶权限类型"},{default:o(()=>[t(X,{modelValue:l(n).accessPolicy,"onUpdate:modelValue":e[16]||(e[16]=a=>l(n).accessPolicy=a)},{default:o(()=>[t(P,{value:"0"},{default:o(()=>e[28]||(e[28]=[m("private")])),_:1}),t(P,{value:"1"},{default:o(()=>e[29]||(e[29]=[m("public")])),_:1}),t(P,{value:"2"},{default:o(()=>e[30]||(e[30]=[m("custom")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"域",prop:"region"},{default:o(()=>[t(c,{modelValue:l(n).region,"onUpdate:modelValue":e[17]||(e[17]=a=>l(n).region=a),placeholder:"请输入域"},null,8,["modelValue"])]),_:1}),t(d,{label:"备注",prop:"remark"},{default:o(()=>[t(c,{modelValue:l(n).remark,"onUpdate:modelValue":e[18]||(e[18]=a=>l(n).remark=a),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{wl as default};
