import{d as X,a as he,h as Ee,ab as K,r as u,ag as O,b as Ce,ah as Ve,c as P,o as p,m as a,q as l,w as c,p as H,e as o,C as ke,D as Se,z as Me,F as Y,A as x,t as w,B as Fe,H as Re,G as f,a6 as J,ai as Ue,b2 as $e,$ as De,v as Pe,Y as Te,y as qe,aj as Ne,n as Be}from"./index-B9WM9B43.js";/* empty css                  *//* empty css                       */import{a as Ie,E as Le}from"./el-radio-Cy5OMmSA.js";import{E as ze}from"./el-card-C9-IEzMj.js";import{_ as Ae}from"./index-F9iJ6oEr.js";import{E as Qe,a as je}from"./el-table-column-CfNB-tiT.js";import"./el-checkbox-CIZQMxKL.js";import{E as Ge}from"./el-row-CZ85bKL9.js";import{_ as Ke}from"./index-CfXeGV0Q.js";import{E as Oe}from"./el-col-DjEila-N.js";import{a as He,E as Ye}from"./el-form-item-C52vg3Rn.js";import{a as xe,g as Je,u as W,b as We,d as Xe}from"./index-BJgmA4Qg.js";import"./_initCloneObject-CtNQcUp4.js";import"./el-tree-FBGJd7y4.js";import"./_baseClone-DI-sfL8c.js";const Ze={class:"p-2"},ea={class:"search"},aa={class:"dialog-footer"},ta=X({name:"Map"}),wa=X({...ta,setup(la){const Z=he(),{proxy:s}=Ee(),{sys_normal_disable:T}=K(s==null?void 0:s.useDict("sys_normal_disable")),q=u([]),E=u(!1),C=u(!0),V=u(!0),k=u([]),N=u(!0),B=u(!0),S=u(0),M=u(!1),I=u(),F=u(),m=O({visible:!1,title:""}),L={id:void 0,name:void 0,description:void 0,filePath:void 0,version:void 0,status:"0"},ee=O({form:{...L},queryParams:{pageNum:1,pageSize:10,name:void 0,status:void 0},rules:{name:[{required:!0,message:"地图模型名称不能为空",trigger:"blur"}]}}),{queryParams:d,form:i,rules:ae}=K(ee),v=async()=>{C.value=!0,M.value=!1;const n=await xe(d.value);q.value=n.rows,S.value=n.total,C.value=!1,Be(()=>{M.value=!0})},te=()=>{R(),m.visible=!1},R=()=>{var n;i.value={...L},(n=F.value)==null||n.resetFields()},U=()=>{d.value.pageNum=1,v()},le=()=>{var n;(n=I.value)==null||n.resetFields(),U()},oe=n=>{k.value=n.map(e=>e.id),N.value=n.length!=1,B.value=!n.length},ne=()=>{R(),m.visible=!0,m.title="添加地图模型"},se=n=>{Z.push({path:"/opentcs/map/editor",query:{id:n.mapId}})},z=async n=>{R();const e=(n==null?void 0:n.id)||k.value[0],g=await Je(e);Object.assign(i.value,g.data),m.visible=!0,m.title="修改地图模型"},ie=()=>{var n;(n=F.value)==null||n.validate(async e=>{e&&(E.value=!0,i.value.id?await W(i.value).finally(()=>E.value=!1):await We(i.value).finally(()=>E.value=!1),s==null||s.$modal.msgSuccess("操作成功"),m.visible=!1,await v())})},A=async n=>{const e=(n==null?void 0:n.id)||k.value;await(s==null?void 0:s.$modal.confirm('是否确认删除地图模型编号为"'+e+'"的数据项？').finally(()=>C.value=!1)),await Xe(e),s==null||s.$modal.msgSuccess("删除成功"),await v()},de=async n=>{if(!M.value)return;const e=n.status==="0"?"启用":"停用";try{await(s==null?void 0:s.$modal.confirm('确认要"'+e+'"吗?')),await W({id:n.id,status:n.status}),s==null||s.$modal.msgSuccess(e+"成功")}catch{n.status=n.status==="0"?"1":"0"}};return Ce(()=>{v()}),(n,e)=>{var j,G;const g=ke,b=Ye,ue=Fe,re=Me,r=Re,Q=He,$=Oe,me=Ke,pe=Ge,_=je,ce=$e,D=De,_e=Qe,fe=Ae,ve=ze,ge=Le,be=Ie,ye=Ne,y=Ve("hasPermi"),we=Pe;return p(),P("div",Ze,[a(Ue,{"enter-active-class":(j=o(s))==null?void 0:j.animate.searchAnimate.enter,"leave-active-class":(G=o(s))==null?void 0:G.animate.searchAnimate.leave},{default:l(()=>[c(H("div",ea,[a(Q,{ref_key:"queryFormRef",ref:I,model:o(d),inline:!0,"label-width":"100px"},{default:l(()=>[a(b,{label:"地图模型名称",prop:"name"},{default:l(()=>[a(g,{modelValue:o(d).name,"onUpdate:modelValue":e[0]||(e[0]=t=>o(d).name=t),placeholder:"请输入地图模型名称",clearable:"",onKeyup:Se(U,["enter"])},null,8,["modelValue"])]),_:1}),a(b,{label:"状态",prop:"status"},{default:l(()=>[a(re,{modelValue:o(d).status,"onUpdate:modelValue":e[1]||(e[1]=t=>o(d).status=t),placeholder:"状态",clearable:""},{default:l(()=>[(p(!0),P(Y,null,x(o(T),t=>(p(),w(ue,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(b,null,{default:l(()=>[a(r,{type:"primary",icon:"Search",onClick:U},{default:l(()=>e[11]||(e[11]=[f("搜索")])),_:1}),a(r,{icon:"Refresh",onClick:le},{default:l(()=>e[12]||(e[12]=[f("重置")])),_:1})]),_:1})]),_:1},8,["model"])],512),[[J,o(V)]])]),_:1},8,["enter-active-class","leave-active-class"]),a(ve,{shadow:"never"},{header:l(()=>[a(pe,{gutter:10,class:"mb8"},{default:l(()=>[a($,{span:1.5},{default:l(()=>[c((p(),w(r,{type:"primary",plain:"",icon:"Plus",onClick:ne},{default:l(()=>e[13]||(e[13]=[f("新增")])),_:1})),[[y,["opentcs:mapModel:add"]]])]),_:1}),a($,{span:1.5},{default:l(()=>[c((p(),w(r,{type:"success",plain:"",icon:"Edit",disabled:o(N),onClick:e[2]||(e[2]=t=>z())},{default:l(()=>e[14]||(e[14]=[f(" 修改 ")])),_:1},8,["disabled"])),[[y,["opentcs:mapModel:edit"]]])]),_:1}),a($,{span:1.5},{default:l(()=>[c((p(),w(r,{type:"danger",plain:"",icon:"Delete",disabled:o(B),onClick:e[3]||(e[3]=t=>A())},{default:l(()=>e[15]||(e[15]=[f(" 删除 ")])),_:1},8,["disabled"])),[[y,["opentcs:mapModel:remove"]]])]),_:1}),a(me,{"show-search":o(V),"onUpdate:showSearch":e[4]||(e[4]=t=>Te(V)?V.value=t:null),onQueryTable:v},null,8,["show-search"])]),_:1})]),default:l(()=>[c((p(),w(_e,{data:o(q),border:"",onSelectionChange:oe},{default:l(()=>[a(_,{type:"selection",width:"55",align:"center"}),a(_,{label:"地图模型ID",align:"center",prop:"mapId",width:"200"}),a(_,{label:"地图模型名称",align:"center",prop:"name"}),a(_,{label:"版本",align:"center",prop:"modelVersion",width:"100"}),a(_,{key:"status",label:"状态",align:"center"},{default:l(t=>[a(ce,{modelValue:t.row.status,"onUpdate:modelValue":h=>t.row.status=h,"active-value":"0","inactive-value":"1",onChange:h=>de(t.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),a(_,{label:"创建时间",align:"center",prop:"createTime",width:"180"}),a(_,{label:"描述",align:"center",prop:"description","show-overflow-tooltip":""}),a(_,{label:"操作",align:"center","class-name":"small-padding fixed-width",width:"150"},{default:l(t=>[a(D,{content:"编辑地图",placement:"top"},{default:l(()=>[c(a(r,{link:"",type:"primary",icon:"EditPen",onClick:h=>se(t.row)},null,8,["onClick"]),[[y,["opentcs:mapModel:edit"]]])]),_:2},1024),a(D,{content:"修改",placement:"top"},{default:l(()=>[c(a(r,{link:"",type:"primary",icon:"Edit",onClick:h=>z(t.row)},null,8,["onClick"]),[[y,["opentcs:mapModel:edit"]]])]),_:2},1024),a(D,{content:"删除",placement:"top"},{default:l(()=>[c(a(r,{link:"",type:"primary",icon:"Delete",onClick:h=>A(t.row)},null,8,["onClick"]),[[y,["opentcs:mapModel:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[we,o(C)]]),c(a(fe,{page:o(d).pageNum,"onUpdate:page":e[5]||(e[5]=t=>o(d).pageNum=t),limit:o(d).pageSize,"onUpdate:limit":e[6]||(e[6]=t=>o(d).pageSize=t),total:o(S),onPagination:v},null,8,["page","limit","total"]),[[J,o(S)>0]])]),_:1}),a(ye,{modelValue:o(m).visible,"onUpdate:modelValue":e[10]||(e[10]=t=>o(m).visible=t),title:o(m).title,width:"500px","append-to-body":""},{footer:l(()=>[H("div",aa,[a(r,{loading:o(E),type:"primary",onClick:ie},{default:l(()=>e[16]||(e[16]=[f("确 定")])),_:1},8,["loading"]),a(r,{onClick:te},{default:l(()=>e[17]||(e[17]=[f("取 消")])),_:1})])]),default:l(()=>[a(Q,{ref_key:"mapFormRef",ref:F,model:o(i),rules:o(ae),"label-width":"120px"},{default:l(()=>[a(b,{label:"地图模型名称",prop:"name"},{default:l(()=>[a(g,{modelValue:o(i).name,"onUpdate:modelValue":e[7]||(e[7]=t=>o(i).name=t),placeholder:"请输入地图模型名称"},null,8,["modelValue"])]),_:1}),a(b,{label:"描述",prop:"description"},{default:l(()=>[a(g,{modelValue:o(i).description,"onUpdate:modelValue":e[8]||(e[8]=t=>o(i).description=t),type:"textarea",rows:3,placeholder:"请输入描述"},null,8,["modelValue"])]),_:1}),a(b,{label:"状态"},{default:l(()=>[a(be,{modelValue:o(i).status,"onUpdate:modelValue":e[9]||(e[9]=t=>o(i).status=t)},{default:l(()=>[(p(!0),P(Y,null,x(o(T),t=>(p(),w(ge,{key:t.value,value:t.value},{default:l(()=>[f(qe(t.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{wa as default};
