import{d as P,u as Z,h as x,ab as ee,r as u,ag as oe,b as te,ah as ae,c as le,o as v,m as e,q as t,w as p,p as T,e as l,C as ne,D as $,H as se,G as _,a6 as A,ai as re,t as y,y as ie,$ as ue,v as me,Y as ce}from"./index-B9WM9B43.js";import{E as pe}from"./el-card-C9-IEzMj.js";import{_ as de}from"./index-F9iJ6oEr.js";import{E as _e,a as fe}from"./el-table-column-CfNB-tiT.js";import"./el-checkbox-CIZQMxKL.js";import{_ as ve}from"./index-vINeM9IP.js";import{E as he}from"./el-row-CZ85bKL9.js";import{_ as ge}from"./index-CfXeGV0Q.js";import{E as we}from"./el-col-DjEila-N.js";import{a as be,E as Ce}from"./el-form-item-C52vg3Rn.js";import{a as ye,b as Ee,c as Ie}from"./index-CcUUMJX9.js";import{_ as ke}from"./selectUser.vue_vue_type_script_setup_true_name_SelectUser_lang-Bjv3dFq5.js";import"./_initCloneObject-CtNQcUp4.js";import"./el-tree-FBGJd7y4.js";import"./_baseClone-DI-sfL8c.js";/* empty css                  */const Ne={class:"p-2"},Se={class:"search"},Ue=P({name:"AuthUser"}),Me=P({...Ue,setup(Re){const F=Z(),{proxy:a}=x(),{sys_normal_disable:q}=ee(a==null?void 0:a.useDict("sys_normal_disable")),E=u([]),h=u(!0),f=u(!0),I=u(!0),g=u(0),k=u([]),N=u(),S=u(),r=oe({pageNum:1,pageSize:10,roleId:F.params.roleId,userName:void 0,phonenumber:void 0}),m=async()=>{h.value=!0;const n=await ye(r);E.value=n.rows,g.value=n.total,h.value=!1},B=()=>{const n={path:"/system/role",fullPath:"",hash:"",matched:[],meta:void 0,name:void 0,params:void 0,query:void 0,redirectedFrom:void 0};a==null||a.$tab.closeOpenPage(n)},d=()=>{r.pageNum=1,m()},D=()=>{var n;(n=N.value)==null||n.resetFields(),d()},L=n=>{k.value=n.map(o=>o.userId),I.value=!n.length},z=()=>{var n;(n=S.value)==null||n.show()},K=async n=>{await(a==null?void 0:a.$modal.confirm('确认要取消该用户"'+n.userName+'"角色吗？')),await Ee({userId:n.userId,roleId:r.roleId}),await m(),a==null||a.$modal.msgSuccess("取消授权成功")},Q=async()=>{const n=r.roleId,o=k.value.join(",");await(a==null?void 0:a.$modal.confirm("是否取消选中用户授权数据项?")),await Ie({roleId:n,userIds:o}),await m(),a==null||a.$modal.msgSuccess("取消授权成功")};return te(()=>{m()}),(n,o)=>{var R,V;const U=ne,w=Ce,c=se,j=be,b=we,O=ge,G=he,i=fe,H=ve,M=ue,Y=_e,J=de,W=pe,C=ae("hasPermi"),X=me;return v(),le("div",Ne,[e(re,{"enter-active-class":(R=l(a))==null?void 0:R.animate.searchAnimate.enter,"leave-active-class":(V=l(a))==null?void 0:V.animate.searchAnimate.leave},{default:t(()=>[p(T("div",Se,[e(j,{ref_key:"queryFormRef",ref:N,model:l(r),inline:!0},{default:t(()=>[e(w,{label:"用户名称",prop:"userName"},{default:t(()=>[e(U,{modelValue:l(r).userName,"onUpdate:modelValue":o[0]||(o[0]=s=>l(r).userName=s),placeholder:"请输入用户名称",clearable:"",onKeyup:$(d,["enter"])},null,8,["modelValue"])]),_:1}),e(w,{label:"手机号码",prop:"phonenumber"},{default:t(()=>[e(U,{modelValue:l(r).phonenumber,"onUpdate:modelValue":o[1]||(o[1]=s=>l(r).phonenumber=s),placeholder:"请输入手机号码",clearable:"",onKeyup:$(d,["enter"])},null,8,["modelValue"])]),_:1}),e(w,null,{default:t(()=>[e(c,{type:"primary",icon:"Search",onClick:d},{default:t(()=>o[5]||(o[5]=[_("搜索")])),_:1}),e(c,{icon:"Refresh",onClick:D},{default:t(()=>o[6]||(o[6]=[_("重置")])),_:1})]),_:1})]),_:1},8,["model"])],512),[[A,l(f)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(W,{shadow:"never"},{header:t(()=>[e(G,{gutter:10},{default:t(()=>[e(b,{span:1.5},{default:t(()=>[p((v(),y(c,{type:"primary",plain:"",icon:"Plus",onClick:z},{default:t(()=>o[7]||(o[7]=[_("添加用户")])),_:1})),[[C,["system:role:add"]]])]),_:1}),e(b,{span:1.5},{default:t(()=>[p((v(),y(c,{type:"danger",plain:"",icon:"CircleClose",disabled:l(I),onClick:Q},{default:t(()=>o[8]||(o[8]=[_(" 批量取消授权 ")])),_:1},8,["disabled"])),[[C,["system:role:remove"]]])]),_:1}),e(b,{span:1.5},{default:t(()=>[e(c,{type:"warning",plain:"",icon:"Close",onClick:B},{default:t(()=>o[9]||(o[9]=[_("关闭")])),_:1})]),_:1}),e(O,{"show-search":l(f),"onUpdate:showSearch":o[2]||(o[2]=s=>ce(f)?f.value=s:null),search:!0,onQueryTable:m},null,8,["show-search"])]),_:1})]),default:t(()=>[p((v(),y(Y,{border:"",data:l(E),onSelectionChange:L},{default:t(()=>[e(i,{type:"selection",width:"55",align:"center"}),e(i,{label:"用户名称",prop:"userName","show-overflow-tooltip":!0}),e(i,{label:"用户昵称",prop:"nickName","show-overflow-tooltip":!0}),e(i,{label:"邮箱",prop:"email","show-overflow-tooltip":!0}),e(i,{label:"手机",prop:"phonenumber","show-overflow-tooltip":!0}),e(i,{label:"状态",align:"center",prop:"status"},{default:t(s=>[e(H,{options:l(q),value:s.row.status},null,8,["options","value"])]),_:1}),e(i,{label:"创建时间",align:"center",prop:"createTime",width:"180"},{default:t(s=>[T("span",null,ie(s.row.createTime),1)]),_:1}),e(i,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:t(s=>[e(M,{content:"取消授权",placement:"top"},{default:t(()=>[p(e(c,{link:"",type:"primary",icon:"CircleClose",onClick:Ve=>K(s.row)},null,8,["onClick"]),[[C,["system:role:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[X,l(h)]]),p(e(J,{page:l(r).pageNum,"onUpdate:page":o[3]||(o[3]=s=>l(r).pageNum=s),limit:l(r).pageSize,"onUpdate:limit":o[4]||(o[4]=s=>l(r).pageSize=s),total:l(g),onPagination:m},null,8,["page","limit","total"]),[[A,l(g)>0]]),e(ke,{ref_key:"selectRef",ref:S,"role-id":l(r).roleId,onOk:d},null,8,["role-id"])]),_:1})])}}});export{Me as default};
