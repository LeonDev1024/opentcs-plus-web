import{a9 as k,d as G,h as de,ab as q,r as i,b as me,ah as pe,c as z,o as d,m as o,q as a,w as p,p as K,e as l,C as ce,D as H,z as fe,F as _e,A as ge,t as _,B as ve,Y as M,H as we,G as g,a6 as Q,ai as be,y as he,v as Ce}from"./index-B9WM9B43.js";import{_ as Ee}from"./index-F9iJ6oEr.js";import{E as ke,a as ye}from"./el-table-column-CfNB-tiT.js";import"./el-checkbox-CIZQMxKL.js";import{_ as De}from"./index-vINeM9IP.js";import{E as Se}from"./el-row-CZ85bKL9.js";import{_ as Ne}from"./index-CfXeGV0Q.js";import{E as Ve}from"./el-col-DjEila-N.js";import{E as Te}from"./el-card-C9-IEzMj.js";import{a as Ie,E as Re}from"./el-form-item-C52vg3Rn.js";import{E as Le}from"./el-date-picker-LQDrgT3l.js";import"./_initCloneObject-CtNQcUp4.js";import"./el-tree-FBGJd7y4.js";import"./_baseClone-DI-sfL8c.js";import"./index-C6vhygJv.js";function Ue(c){return k({url:"/monitor/logininfor/list",method:"get",params:c})}function Be(c){return k({url:"/monitor/logininfor/"+c,method:"delete"})}function $e(c){return k({url:"/monitor/logininfor/unlock/"+c,method:"get"})}function Fe(){return k({url:"/monitor/logininfor/clean",method:"delete"})}const Ae={class:"p-2"},Pe={class:"mb-[10px]"},Ye=G({name:"Logininfor"}),oo=G({...Ye,setup(c){const{proxy:t}=de(),{sys_device_type:O}=q(t==null?void 0:t.useDict("sys_device_type")),{sys_common_status:N}=q(t==null?void 0:t.useDict("sys_common_status")),V=i([]),y=i(!0),h=i(!0),T=i([]),I=i(!0),R=i(!0),L=i([]),D=i(0),v=i(["",""]),w=i({prop:"loginTime",order:"descending"}),U=i(),B=i(),r=i({pageNum:1,pageSize:10,ipaddr:"",userName:"",status:"",orderByColumn:w.value.prop,isAsc:w.value.order}),m=async()=>{y.value=!0;const s=await Ue(t==null?void 0:t.addDateRange(r.value,v.value));V.value=s.rows,D.value=s.total,y.value=!1},S=()=>{r.value.pageNum=1,m()},j=()=>{var s,e;v.value=["",""],(s=U.value)==null||s.resetFields(),r.value.pageNum=1,(e=B.value)==null||e.sort(w.value.prop,w.value.order)},J=s=>{T.value=s.map(e=>e.infoId),R.value=!s.length,I.value=s.length!=1,L.value=s.map(e=>e.userName)},W=s=>{r.value.orderByColumn=s.prop,r.value.isAsc=s.order,m()},X=async s=>{const e=T.value;await(t==null?void 0:t.$modal.confirm('是否确认删除访问编号为"'+e+'"的数据项?')),await Be(e),await m(),t==null||t.$modal.msgSuccess("删除成功")},Z=async()=>{await(t==null?void 0:t.$modal.confirm("是否确认清空所有登录日志数据项?")),await Fe(),await m(),t==null||t.$modal.msgSuccess("清空成功")},x=async()=>{const s=L.value;await(t==null?void 0:t.$modal.confirm('是否确认解锁用户"'+s+'"数据项?')),await $e(s),t==null||t.$modal.msgSuccess("用户"+s+"解锁成功")},ee=()=>{t==null||t.download("monitor/logininfor/export",{...r.value},`logininfor_${new Date().getTime()}.xlsx`)};return me(()=>{m()}),(s,e)=>{var P,Y;const $=ce,b=Re,oe=ve,te=fe,le=Le,f=we,ae=Ie,F=Te,C=Ve,ne=Ne,se=Se,u=ye,A=De,re=ke,ie=Ee,E=pe("hasPermi"),ue=Ce;return d(),z("div",Ae,[o(be,{"enter-active-class":(P=l(t))==null?void 0:P.animate.searchAnimate.enter,"leave-active-class":(Y=l(t))==null?void 0:Y.animate.searchAnimate.leave},{default:a(()=>[p(K("div",Pe,[o(F,{shadow:"hover"},{default:a(()=>[o(ae,{ref_key:"queryFormRef",ref:U,model:l(r),inline:!0},{default:a(()=>[o(b,{label:"登录地址",prop:"ipaddr"},{default:a(()=>[o($,{modelValue:l(r).ipaddr,"onUpdate:modelValue":e[0]||(e[0]=n=>l(r).ipaddr=n),placeholder:"请输入登录地址",clearable:"",onKeyup:H(S,["enter"])},null,8,["modelValue"])]),_:1}),o(b,{label:"用户名称",prop:"userName"},{default:a(()=>[o($,{modelValue:l(r).userName,"onUpdate:modelValue":e[1]||(e[1]=n=>l(r).userName=n),placeholder:"请输入用户名称",clearable:"",onKeyup:H(S,["enter"])},null,8,["modelValue"])]),_:1}),o(b,{label:"状态",prop:"status"},{default:a(()=>[o(te,{modelValue:l(r).status,"onUpdate:modelValue":e[2]||(e[2]=n=>l(r).status=n),placeholder:"登录状态",clearable:""},{default:a(()=>[(d(!0),z(_e,null,ge(l(N),n=>(d(),_(oe,{key:n.value,label:n.label,value:n.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(b,{label:"登录时间",style:{width:"308px"}},{default:a(()=>[o(le,{modelValue:l(v),"onUpdate:modelValue":e[3]||(e[3]=n=>M(v)?v.value=n:null),"value-format":"YYYY-MM-DD HH:mm:ss",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":[new Date(2e3,1,1,0,0,0),new Date(2e3,1,1,23,59,59)]},null,8,["modelValue","default-time"])]),_:1}),o(b,null,{default:a(()=>[o(f,{type:"primary",icon:"Search",onClick:S},{default:a(()=>e[8]||(e[8]=[g("搜索")])),_:1}),o(f,{icon:"Refresh",onClick:j},{default:a(()=>e[9]||(e[9]=[g("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[Q,l(h)]])]),_:1},8,["enter-active-class","leave-active-class"]),o(F,{shadow:"hover"},{header:a(()=>[o(se,{gutter:10,class:"mb8"},{default:a(()=>[o(C,{span:1.5},{default:a(()=>[p((d(),_(f,{type:"danger",plain:"",icon:"Delete",disabled:l(R),onClick:e[4]||(e[4]=n=>X())},{default:a(()=>e[10]||(e[10]=[g(" 删除 ")])),_:1},8,["disabled"])),[[E,["monitor:logininfor:remove"]]])]),_:1}),o(C,{span:1.5},{default:a(()=>[p((d(),_(f,{type:"danger",plain:"",icon:"Delete",onClick:Z},{default:a(()=>e[11]||(e[11]=[g("清空")])),_:1})),[[E,["monitor:logininfor:remove"]]])]),_:1}),o(C,{span:1.5},{default:a(()=>[p((d(),_(f,{type:"primary",plain:"",icon:"Unlock",disabled:l(I),onClick:x},{default:a(()=>e[12]||(e[12]=[g(" 解锁 ")])),_:1},8,["disabled"])),[[E,["monitor:logininfor:unlock"]]])]),_:1}),o(C,{span:1.5},{default:a(()=>[p((d(),_(f,{type:"warning",plain:"",icon:"Download",onClick:ee},{default:a(()=>e[13]||(e[13]=[g("导出")])),_:1})),[[E,["monitor:logininfor:export"]]])]),_:1}),o(ne,{"show-search":l(h),"onUpdate:showSearch":e[5]||(e[5]=n=>M(h)?h.value=n:null),onQueryTable:m},null,8,["show-search"])]),_:1})]),default:a(()=>[p((d(),_(re,{ref_key:"loginInfoTableRef",ref:B,data:l(V),"default-sort":l(w),border:"",onSelectionChange:J,onSortChange:W},{default:a(()=>[o(u,{type:"selection",width:"55",align:"center"}),o(u,{label:"访问编号",align:"center",prop:"infoId"}),o(u,{label:"用户名称",align:"center",prop:"userName","show-overflow-tooltip":!0,sortable:"custom","sort-orders":["descending","ascending"]}),o(u,{label:"客户端",align:"center",prop:"clientKey","show-overflow-tooltip":!0}),o(u,{label:"设备类型",align:"center"},{default:a(n=>[o(A,{options:l(O),value:n.row.deviceType},null,8,["options","value"])]),_:1}),o(u,{label:"地址",align:"center",prop:"ipaddr","show-overflow-tooltip":!0}),o(u,{label:"登录地点",align:"center",prop:"loginLocation","show-overflow-tooltip":!0}),o(u,{label:"操作系统",align:"center",prop:"os","show-overflow-tooltip":!0}),o(u,{label:"浏览器",align:"center",prop:"browser","show-overflow-tooltip":!0}),o(u,{label:"登录状态",align:"center",prop:"status"},{default:a(n=>[o(A,{options:l(N),value:n.row.status},null,8,["options","value"])]),_:1}),o(u,{label:"描述",align:"center",prop:"msg","show-overflow-tooltip":!0}),o(u,{label:"访问时间",align:"center",prop:"loginTime",sortable:"custom","sort-orders":["descending","ascending"],width:"180"},{default:a(n=>[K("span",null,he(l(t).parseTime(n.row.loginTime)),1)]),_:1})]),_:1},8,["data","default-sort"])),[[ue,l(y)]]),p(o(ie,{page:l(r).pageNum,"onUpdate:page":e[6]||(e[6]=n=>l(r).pageNum=n),limit:l(r).pageSize,"onUpdate:limit":e[7]||(e[7]=n=>l(r).pageSize=n),total:l(D),onPagination:m},null,8,["page","limit","total"]),[[Q,l(D)>0]])]),_:1})])}}});export{oo as default};
