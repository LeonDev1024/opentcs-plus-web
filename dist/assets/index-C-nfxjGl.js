import{a9 as V,d as ae,h as Ce,ab as X,r as f,ag as Z,b as we,ah as ke,c as U,o as m,m as e,q as l,w as y,p as A,e as o,C as Ie,D as ee,z as Ne,F as x,A as B,t as h,B as De,H as Ue,G as g,a6 as Te,ai as Re,y as te,$ as Fe,v as Se,Y as $e,x as qe,aj as Ae}from"./index-B9WM9B43.js";/* empty css                  *//* empty css                       */import{a as xe,E as Be}from"./el-radio-Cy5OMmSA.js";import{E as Pe}from"./el-input-number-CWw6lCGD.js";import"./el-tree-FBGJd7y4.js";import"./el-checkbox-CIZQMxKL.js";import{E as Le}from"./el-tree-select-CQI-h92h.js";import{E as Ke,a as Oe}from"./el-table-column-CfNB-tiT.js";import{_ as Qe}from"./index-vINeM9IP.js";import{E as ze}from"./el-row-CZ85bKL9.js";import{_ as Ge}from"./index-CfXeGV0Q.js";import{E as je}from"./el-col-DjEila-N.js";import{E as He}from"./el-card-C9-IEzMj.js";import{a as Me,E as Ye}from"./el-form-item-C52vg3Rn.js";import{l as Je}from"./index-CUfbmLco.js";import"./index-C6vhygJv.js";import"./_initCloneObject-CtNQcUp4.js";import"./_baseClone-DI-sfL8c.js";const le=p=>V({url:"/system/dept/list",method:"get",params:p}),We=p=>V({url:"/system/dept/list/exclude/"+p,method:"get"}),Xe=p=>V({url:"/system/dept/"+p,method:"get"}),Ze=p=>V({url:"/system/dept",method:"post",data:p}),et=p=>V({url:"/system/dept",method:"put",data:p}),tt=p=>V({url:"/system/dept/"+p,method:"delete"}),lt={class:"p-2"},at={class:"mb-[10px]"},ot={class:"dialog-footer"},nt=ae({name:"Dept"}),kt=ae({...nt,setup(p){const{proxy:d}=Ce(),{sys_normal_disable:T}=X(d==null?void 0:d.useDict("sys_normal_disable")),R=f([]),F=f(!0),C=f(!0),w=f([]),k=f(!0),P=f([]),c=Z({visible:!1,title:""}),L=f(),K=f(),S=f(),O={deptId:void 0,parentId:void 0,deptName:void 0,deptCategory:void 0,orderNum:0,leader:void 0,phone:void 0,email:void 0,status:"0"},oe={form:{...O},queryParams:{pageNum:1,pageSize:10,deptName:void 0,deptCategory:void 0,status:void 0},rules:{parentId:[{required:!0,message:"上级部门不能为空",trigger:"blur"}],deptName:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],orderNum:[{required:!0,message:"显示排序不能为空",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],phone:[{pattern:/^1[3456789][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]}},ne=Z(oe),{queryParams:v,form:s,rules:de}=X(ne),E=async()=>{F.value=!0;const n=await le(v.value),t=d==null?void 0:d.handleTree(n.data,"deptId");t&&(R.value=t),F.value=!1};async function se(n){if(n!==null&&n!==""&&n!==void 0){const t=await Je(n);P.value=t.data}}const re=()=>{$(),c.visible=!1},$=()=>{var n;s.value={...O},(n=S.value)==null||n.resetFields()},I=()=>{E()},ue=()=>{var n;(n=K.value)==null||n.resetFields(),I()},pe=()=>{k.value=!k.value,Q(R.value,k.value)},Q=(n,t)=>{n.forEach(u=>{var r;(r=L.value)==null||r.toggleRowExpansion(u,t),u.children&&u.children.length>0&&Q(u.children,t)})},z=async n=>{$();const t=await le(),u=d==null?void 0:d.handleTree(t.data,"deptId");u&&(w.value=u,n&&n.deptId&&(s.value.parentId=n==null?void 0:n.deptId),c.visible=!0,c.title="添加部门")},ie=async n=>{$(),se(n.deptId);const t=await Xe(n.deptId);s.value=t.data;const u=await We(n.deptId),r=d==null?void 0:d.handleTree(u.data,"deptId");if(r&&(w.value=r,r.length===0)){const N={deptId:t.data.parentId,deptName:t.data.parentName,children:[]};w.value.push(N)}c.visible=!0,c.title="修改部门"},me=()=>{var n;(n=S.value)==null||n.validate(async t=>{t&&(s.value.deptId?await et(s.value):await Ze(s.value),d==null||d.$modal.msgSuccess("操作成功"),c.visible=!1,await E())})},ce=async n=>{await(d==null?void 0:d.$modal.confirm('是否确认删除名称为"'+n.deptName+'"的数据项?')),await tt(n.deptId),await E(),d==null||d.$modal.msgSuccess("删除成功")};return we(()=>{E()}),(n,t)=>{var Y,J;const u=Ie,r=Ye,N=De,G=Ne,_=Ue,j=Me,H=He,i=je,_e=Ge,M=ze,b=Oe,fe=Qe,q=Fe,ve=Ke,ge=Le,be=Pe,ye=Be,he=xe,Ve=Ae,D=ke("hasPermi"),Ee=Se;return m(),U("div",lt,[e(Re,{"enter-active-class":(Y=o(d))==null?void 0:Y.animate.searchAnimate.enter,"leave-active-class":(J=o(d))==null?void 0:J.animate.searchAnimate.leave},{default:l(()=>[y(A("div",at,[e(H,{shadow:"hover"},{default:l(()=>[e(j,{ref_key:"queryFormRef",ref:K,model:o(v),inline:!0},{default:l(()=>[e(r,{label:"部门名称",prop:"deptName"},{default:l(()=>[e(u,{modelValue:o(v).deptName,"onUpdate:modelValue":t[0]||(t[0]=a=>o(v).deptName=a),placeholder:"请输入部门名称",clearable:"",onKeyup:ee(I,["enter"])},null,8,["modelValue"])]),_:1}),e(r,{label:"类别编码",prop:"deptCategory"},{default:l(()=>[e(u,{modelValue:o(v).deptCategory,"onUpdate:modelValue":t[1]||(t[1]=a=>o(v).deptCategory=a),placeholder:"请输入类别编码",clearable:"",style:{width:"240px"},onKeyup:ee(I,["enter"])},null,8,["modelValue"])]),_:1}),e(r,{label:"状态",prop:"status"},{default:l(()=>[e(G,{modelValue:o(v).status,"onUpdate:modelValue":t[2]||(t[2]=a=>o(v).status=a),placeholder:"部门状态",clearable:""},{default:l(()=>[(m(!0),U(x,null,B(o(T),a=>(m(),h(N,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(r,null,{default:l(()=>[e(_,{type:"primary",icon:"Search",onClick:I},{default:l(()=>t[14]||(t[14]=[g("搜索")])),_:1}),e(_,{icon:"Refresh",onClick:ue},{default:l(()=>t[15]||(t[15]=[g("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[Te,o(C)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(H,{shadow:"hover"},{header:l(()=>[e(M,{gutter:10},{default:l(()=>[e(i,{span:1.5},{default:l(()=>[y((m(),h(_,{type:"primary",plain:"",icon:"Plus",onClick:t[3]||(t[3]=a=>z())},{default:l(()=>t[16]||(t[16]=[g("新增 ")])),_:1})),[[D,["system:dept:add"]]])]),_:1}),e(i,{span:1.5},{default:l(()=>[e(_,{type:"info",plain:"",icon:"Sort",onClick:pe},{default:l(()=>t[17]||(t[17]=[g("展开/折叠")])),_:1})]),_:1}),e(_e,{"show-search":o(C),"onUpdate:showSearch":t[4]||(t[4]=a=>$e(C)?C.value=a:null),onQueryTable:E},null,8,["show-search"])]),_:1})]),default:l(()=>[y((m(),h(ve,{ref_key:"deptTableRef",ref:L,data:o(R),"row-key":"deptId",border:"","tree-props":{children:"children",hasChildren:"hasChildren"},"default-expand-all":o(k)},{default:l(()=>[e(b,{prop:"deptName",label:"部门名称",width:"260"}),e(b,{prop:"deptCategory",align:"center",label:"类别编码",width:"200"}),e(b,{prop:"orderNum",align:"center",label:"排序",width:"200"}),e(b,{prop:"status",align:"center",label:"状态",width:"100"},{default:l(a=>[e(fe,{options:o(T),value:a.row.status},null,8,["options","value"])]),_:1}),e(b,{label:"创建时间",align:"center",prop:"createTime",width:"200"},{default:l(a=>[A("span",null,te(o(d).parseTime(a.row.createTime)),1)]),_:1}),e(b,{fixed:"right",align:"center",label:"操作"},{default:l(a=>[e(q,{content:"修改",placement:"top"},{default:l(()=>[y(e(_,{link:"",type:"primary",icon:"Edit",onClick:W=>ie(a.row)},null,8,["onClick"]),[[D,["system:dept:edit"]]])]),_:2},1024),e(q,{content:"新增",placement:"top"},{default:l(()=>[y(e(_,{link:"",type:"primary",icon:"Plus",onClick:W=>z(a.row)},null,8,["onClick"]),[[D,["system:dept:add"]]])]),_:2},1024),e(q,{content:"删除",placement:"top"},{default:l(()=>[y(e(_,{link:"",type:"primary",icon:"Delete",onClick:W=>ce(a.row)},null,8,["onClick"]),[[D,["system:dept:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data","default-expand-all"])),[[Ee,o(F)]])]),_:1}),e(Ve,{modelValue:o(c).visible,"onUpdate:modelValue":t[13]||(t[13]=a=>o(c).visible=a),title:o(c).title,"destroy-on-close":"","append-to-body":"",width:"600px"},{footer:l(()=>[A("div",ot,[e(_,{type:"primary",onClick:me},{default:l(()=>t[18]||(t[18]=[g("确 定")])),_:1}),e(_,{onClick:re},{default:l(()=>t[19]||(t[19]=[g("取 消")])),_:1})])]),default:l(()=>[e(j,{ref_key:"deptFormRef",ref:S,model:o(s),rules:o(de),"label-width":"80px"},{default:l(()=>[e(M,null,{default:l(()=>[o(s).parentId!==0?(m(),h(i,{key:0,span:24},{default:l(()=>[e(r,{label:"上级部门",prop:"parentId"},{default:l(()=>[e(ge,{modelValue:o(s).parentId,"onUpdate:modelValue":t[5]||(t[5]=a=>o(s).parentId=a),data:o(w),props:{value:"deptId",label:"deptName",children:"children"},"value-key":"deptId",placeholder:"选择上级部门","check-strictly":""},null,8,["modelValue","data"])]),_:1})]),_:1})):qe("",!0),e(i,{span:12},{default:l(()=>[e(r,{label:"部门名称",prop:"deptName"},{default:l(()=>[e(u,{modelValue:o(s).deptName,"onUpdate:modelValue":t[6]||(t[6]=a=>o(s).deptName=a),placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:l(()=>[e(r,{label:"类别编码",prop:"deptCategory"},{default:l(()=>[e(u,{modelValue:o(s).deptCategory,"onUpdate:modelValue":t[7]||(t[7]=a=>o(s).deptCategory=a),placeholder:"请输入类别编码"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:l(()=>[e(r,{label:"显示排序",prop:"orderNum"},{default:l(()=>[e(be,{modelValue:o(s).orderNum,"onUpdate:modelValue":t[8]||(t[8]=a=>o(s).orderNum=a),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:l(()=>[e(r,{label:"负责人",prop:"leader"},{default:l(()=>[e(G,{modelValue:o(s).leader,"onUpdate:modelValue":t[9]||(t[9]=a=>o(s).leader=a),placeholder:"请选择负责人"},{default:l(()=>[(m(!0),U(x,null,B(o(P),a=>(m(),h(N,{key:a.userId,label:a.userName,value:a.userId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:l(()=>[e(r,{label:"联系电话",prop:"phone"},{default:l(()=>[e(u,{modelValue:o(s).phone,"onUpdate:modelValue":t[10]||(t[10]=a=>o(s).phone=a),placeholder:"请输入联系电话",maxlength:"11"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:l(()=>[e(r,{label:"邮箱",prop:"email"},{default:l(()=>[e(u,{modelValue:o(s).email,"onUpdate:modelValue":t[11]||(t[11]=a=>o(s).email=a),placeholder:"请输入邮箱",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:l(()=>[e(r,{label:"部门状态"},{default:l(()=>[e(he,{modelValue:o(s).status,"onUpdate:modelValue":t[12]||(t[12]=a=>o(s).status=a)},{default:l(()=>[(m(!0),U(x,null,B(o(T),a=>(m(),h(ye,{key:a.value,value:a.value},{default:l(()=>[g(te(a.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{kt as default};
